(function(d){var h=function(){var a=d.documentMode;return"onhashchange"in d&&(void 0===a||7<a)}();L.Hash=function(a,b){this.onHashChange=L.Util.bind(this.onHashChange,this);a&&this.init(a,b)};L.Hash.parseHash=function(a){0===a.indexOf("#")&&(a=a.substr(1));a=a.split("/");if(2<a.length){var b=parseInt(a[0],10),c=parseFloat(a[1]);lon=parseFloat(a[2]);var e=null;a[3]&&(e=a[3].split("-"));return isNaN(b)||isNaN(c)||isNaN(lon)?!1:{center:new L.LatLng(c,lon),zoom:b,layers:e}}return!1};L.Hash.formatHash=
function(a){var b=a.getCenter(),c=a.getZoom(),e=Math.max(0,Math.ceil(Math.log(c)/Math.LN2)),d=[],f=this.options,g;for(g in f)f.hasOwnProperty(g)&&a.hasLayer(f[g])&&d.push(g);return"#"+[c,b.lat.toFixed(e),b.lng.toFixed(e),d.join("-")].join("/")};L.Hash.prototype={map:null,lastHash:null,parseHash:L.Hash.parseHash,formatHash:L.Hash.formatHash,init:function(a,b){this.map=a;L.Util.setOptions(this,b);this.lastHash=null;this.onHashChange();this.isListening||this.startListening()},removeFrom:function(a){this.changeTimeout&&
clearTimeout(this.changeTimeout);this.isListening&&this.stopListening();this.map=null},onMapMove:function(){if(this.movingMap||!this.map._loaded)return!1;var a=this.formatHash(this.map);this.lastHash!=a&&(location.replace(a),this.lastHash=a)},movingMap:!1,update:function(){var a=location.hash;if(a!==this.lastHash)if(a=this.parseHash(a)){this.movingMap=!0;this.map.setView(a.center,a.zoom);var a=a.layers,b=this.options,c=this;a&&(this.map.eachLayer(function(a){c.map.removeLayer(a)}),a.forEach(function(a,
d,f){c.map.addLayer(b[a])}));this.movingMap=!1}else this.onMapMove(this.map)},changeDefer:100,changeTimeout:null,onHashChange:function(){if(!this.changeTimeout){var a=this;this.changeTimeout=setTimeout(function(){a.update();a.changeTimeout=null},this.changeDefer)}},isListening:!1,hashChangeInterval:null,startListening:function(){this.map.on("moveend layeradd layerremove",this.onMapMove,this);h?L.DomEvent.addListener(d,"hashchange",this.onHashChange):(clearInterval(this.hashChangeInterval),this.hashChangeInterval=
setInterval(this.onHashChange,50));this.isListening=!0},stopListening:function(){this.map.off("moveend layeradd layerremove",this.onMapMove,this);h?L.DomEvent.removeListener(d,"hashchange",this.onHashChange):clearInterval(this.hashChangeInterval);this.isListening=!1},_keyByValue:function(a,b){for(var c in a)if(a.hasOwnProperty(c))return a[c]===b?c:null}};L.hash=function(a,b){return new L.Hash(a,b)};L.Map.prototype.addHash=function(){this._hash=L.hash(this,this.options)};L.Map.prototype.removeHash=
function(){this._hash.removeFrom()}})(window);
